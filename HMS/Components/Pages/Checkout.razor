@page "/checkout"
@using Google.Cloud.Firestore;
@rendermode InteractiveServer
@inject BookingService BookingService

<PageTitle>Checkout</PageTitle>


<div class="container mx-auto py-10">
    <h1 class="text-3xl font-bold mb-6">Checkout</h1>
        <div className="grid gap-6 lg:grid-cols-2">
            <div class="row">
            <div class="col-sm">
            <Card>
                <CardBody>
                    <!-- database Information goes here-->
                    <CardTitle>Reservation Summary</CardTitle>
                    <CardSubTitle Class="mb-2 text-muted">Review your booking details</CardSubTitle>
                    <hr class="my-4" />
                    <div class="mb-4">
                    <div class="d-flex justify-content-between">
                            <span>Hotel:</span>
                            <span class="fw-semibold">@BookingService.HotelName</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Room Type:</span>
                            <span class="fw-semibold">@BookingService.RoomType</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Check-in:</span>
                            <span class="fw-semibold">@BookingService.CheckInDate</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Check-out:</span>
                            <span class="fw-semibold">@BookingService.CheckOutDate</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Guests:</span>
                            <span class="fw-semibold">@BookingService.Guests</span>
                    </div>
                    </div>
                </CardBody>
                    <hr class="my-4" />
                    <CardBody>
                        <div class="mb-4">
                            <div class="d-flex justify-content-between fs-5 fw-semibold">
                                <span>Total:</span>
                                <span>@BookingService.TotalPrice</span>
                        </div>
                        </div>
                    </CardBody>
            </Card>
            </div>

            <div class="col-sm">
            <Card>
                <CardBody>
                    <CardTitle>Guest Information</CardTitle>
                    <CardSubTitle Class="mb-2 text-muted">Please provide your details</CardSubTitle>
                    <hr class="my-4" />
                    <div class="mb-4">
                        <div class="row g-4">
                            <!-- First Name -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="firstName" class="form-label">First Name</label>
                                    <input type="text" @bind="FirstName" id="firstName" class="form-control" placeholder="John" />
                                </div>
                            </div>
                            <!-- Last Name -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="lastName" class="form-label">Last Name</label>
                                    <input type="text" @bind="LastName" id="lastName" class="form-control" placeholder="Doe" />
                                </div>
                            </div>
                        </div>
                        <!-- Email -->
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" id="email"  @bind="Email"  class="form-control" placeholder="john.doe@example.com" />
                        </div>
                        <!-- Phone Number -->
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" id="phone" @bind="PhoneNumber" class="form-control" placeholder="+1 (555) 123-4567" />
                        </div>
                    </div>
                </CardBody>
            </Card>

            
            <Card>
                <CardBody>
                    <CardTitle>Payment Information</CardTitle>
                    <CardSubTitle Class="mb-2 text-muted">Secure payment processing</CardSubTitle>
                    <hr class="my-4" />
                    <div class="mb-4">
                        <!-- Card Number -->
                        <div class="mb-3">
                            <label for="cardNumber" class="form-label">Card Number</label>
                            <input type="text" id="cardNumber" class="form-control" placeholder="1234 5678 9012 3456" />
                        </div>

                        <!-- Expiry Date and CVV -->
                        <div class="row g-4">
                            <!-- Expiry Date -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="expiryDate" class="form-label">Expiry Date</label>
                                    <input type="text" id="expiryDate" class="form-control" placeholder="MM/YY" />
                                </div>
                            </div>
                            <!-- CVV -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="cvv" class="form-label">CVV</label>
                                    <input type="text" id="cvv" class="form-control" placeholder="123" />
                                </div>
                            </div>
                        </div>

                        <!-- Cardholder Name -->
                        <div class="mb-3">
                            <label for="cardholderName" class="form-label">Cardholder Name</label>
                            <input type="text" id="cardholderName" class="form-control" placeholder="John Doe" />
                        </div>

                        <!-- Country -->
                        <div class="mb-3">
                            <label for="country" class="form-label">Country</label>
                            <select id="country" class="form-select">
                                <option value="" disabled selected>Select a country</option>
                                <option value="us">United States</option>
                                <option value="ca">Canada</option>
                                <option value="uk">United Kingdom</option>
                                <option value="au">Australia</option>
                            </select>
                        </div>
                    </div>
                    <hr class="my-4" />
                    <Button Color="ButtonColor.Dark" button @onclick="SubmitBooking" Type="ButtonType.Link"> Confirm Reservation </Button>
                </CardBody>
            </Card>

            </div>


            </div>
        </div>
</div>

@code {
    private string FirstName;
    private string LastName;
    private string Email;
    private string PhoneNumber;


    FirestoreDb db = FirestoreDb.Create("hotelmanagementsystem-3f342");

    private async Task SubmitBooking()
    {
        // Add Firestore logic here to save booking data
        var bookingDetails = new
        {
            BookingService.HotelName,
            BookingService.RoomType,
            BookingService.CheckInDate,
            BookingService.CheckOutDate,
            BookingService.Guests,
            BookingService.TotalPrice,
            FirstName,
            LastName,
            Email,
            PhoneNumber
        };
        DocumentReference docRef = db.Collection("Reservations").Document();
        await docRef.SetAsync(bookingDetails);

        Console.WriteLine($"Booking confirmed for {FirstName} {LastName}");
    }
}

